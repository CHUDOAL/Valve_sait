# Valve Corporation Portal

Корпоративный портал компании Valve с системой управления задачами и личными кабинетами.

## Описание

Это приложение представляет собой полнофункциональный корпоративный портал с:

- **Главная страница** - информация о компании Valve и ее играх
- **Система авторизации** - регистрация и вход пользователей
- **Личный кабинет** - редактирование профиля (никнейм, аватарка, описание)
- **Система ролей** - начальник и подчиненный
- **Управление задачами** - начальник создает задачи для подчиненных, подчиненные видят свои задачи и меняют статус
- **Современный дизайн** - темная тема с градиентами и анимациями

## Деплой на хостинг

Подробные инструкции по деплою на различные хостинги смотрите в файле [DEPLOY.md](DEPLOY.md)

## Установка

### 1. Установка Python зависимостей

**Примечание:** SQLite не требует отдельной установки - это встроенная база данных, которая работает из коробки с Python!

1. Создайте виртуальное окружение (если еще не создано):
```bash
python -m venv .venv
```

2. Активируйте виртуальное окружение:
- Windows:
```bash
.venv\Scripts\activate
```
- Linux/Mac:
```bash
source .venv/bin/activate
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск

### Первый запуск

При первом запуске приложение автоматически создаст все необходимые таблицы в базе данных.

```bash
uvicorn main:app --reload
```

Или используйте Python:
```bash
python main.py
```

Приложение будет доступно по адресу: http://localhost:8000

**Примечание:** SQLite создаст файл `valve_portal.db` в корне проекта автоматически при первом запуске. Никаких дополнительных настроек не требуется!

## Использование

### Тестовый аккаунт

При первом запуске автоматически создается тестовый аккаунт начальника:
- **Email**: `boss@valve.com`
- **Пароль**: `admin123`

### Регистрация

1. Перейдите на страницу регистрации: http://localhost:8000/register
2. Заполните форму:
   - Никнейм
   - Email
   - Пароль
   - Роль (начальник или подчиненный)
3. После регистрации вы будете перенаправлены в личный кабинет

### Личный кабинет

В личном кабинете вы можете:
- **Редактировать профиль** - изменить никнейм, добавить аватарку (URL), написать описание
- **Просматривать задачи**:
  - **Начальник** видит все задачи, которые он создал, и может создавать новые
  - **Подчиненный** видит задачи, назначенные ему, и может менять их статус

### Создание задач (только для начальника)

1. В личном кабинете нажмите кнопку "Создать задачу"
2. Заполните форму:
   - Название задачи
   - Описание
   - Выберите подчиненного из списка
3. Задача будет создана и назначена выбранному подчиненному

### Изменение статуса задачи (только для подчиненного)

Подчиненный может изменить статус назначенной ему задачи:
- **В ожидании** - задача создана, но еще не начата
- **В работе** - задача выполняется
- **Выполнено** - задача завершена

## Основные эндпоинты API

### Авторизация
- `POST /api/register` - регистрация нового пользователя
- `POST /api/login` - вход в систему
- `POST /api/logout` - выход из системы

### Пользователь
- `GET /api/user` - получить текущего пользователя
- `PATCH /api/user` - обновить профиль
- `GET /api/user/{user_id}` - получить пользователя по ID
- `GET /api/users` - получить список подчиненных (только для начальника)

### Задачи
- `GET /api/tasks` - получить задачи пользователя
- `POST /api/tasks` - создать задачу (только для начальника)
- `PATCH /api/tasks/{task_id}` - обновить задачу

### Страницы
- `GET /` - главная страница о Valve
- `GET /login` - страница авторизации
- `GET /register` - страница регистрации
- `GET /profile` - личный кабинет

## Особенности реализации

### Backend
- **Асинхронность** - все эндпоинты используют `async/await`
- **База данных** - SQLite с использованием SQLAlchemy ORM (файловая БД, не требует отдельного сервера)
- **Авторизация** - система сессий с использованием cookies и таблицы sessions в БД
- **Роли** - два типа ролей: начальник (boss) и подчиненный (employee)
- **Валидация** - использование Pydantic для валидации данных
- **Хеширование паролей** - SHA-256 для безопасности
- **Персистентность данных** - все данные сохраняются в SQLite (файл `valve_portal.db`)

### Frontend
- **Современный дизайн** - темная тема с градиентами
- **Адаптивность** - работает на разных размерах экранов
- **Интерактивность** - уведомления, анимации, плавные переходы
- **Vanilla JavaScript** - без дополнительных фреймворков

## Технологии

### Backend
- **FastAPI** - современный веб-фреймворк для создания API
- **Uvicorn** - ASGI сервер для запуска приложения
- **SQLite** - легковесная файловая база данных (встроена в Python)
- **SQLAlchemy** - ORM для работы с БД
- **aiosqlite** - асинхронный драйвер для SQLite
- **Pydantic** - библиотека для валидации данных
- **Jinja2** - шаблонизатор для HTML
- **Alembic** - инструмент для миграций БД
- **python-dotenv** - загрузка переменных окружения
- **asyncio** - стандартная библиотека Python для асинхронного программирования

### Frontend
- **HTML5** - структура веб-страницы
- **CSS3** - современные стили с градиентами и анимациями
- **Vanilla JavaScript** - чистый JavaScript для взаимодействия с API
- **Fetch API** - для асинхронных HTTP-запросов

## Структура проекта

```
.
├── main.py              # Основной файл FastAPI приложения
├── database.py          # Настройка подключения к SQLite
├── models.py            # SQLAlchemy модели (User, Task, Session)
├── requirements.txt     # Зависимости проекта
├── .env                 # Переменные окружения (опционально)
├── valve_portal.db      # Файл базы данных SQLite (создается автоматически)
├── alembic.ini          # Конфигурация Alembic для миграций
├── README.md           # Документация
├── templates/          # HTML шаблоны
│   ├── index.html      # Главная страница о Valve
│   ├── login.html      # Страница авторизации
│   ├── register.html   # Страница регистрации
│   └── profile.html    # Личный кабинет
└── static/             # Статические файлы
    ├── style.css       # Стили приложения
    └── script.js       # JavaScript логика
```

## База данных

Приложение использует **SQLite** - легковесную файловую базу данных. Преимущества:

- ✅ **Не требует установки** - SQLite встроена в Python
- ✅ **Не требует отдельного сервера** - работает из коробки
- ✅ **Автоматическое создание** - файл БД создается автоматически
- ✅ **Простота** - один файл `valve_portal.db` содержит все данные

При первом запуске автоматически создаются следующие таблицы:

- **users** - пользователи системы
- **tasks** - задачи
- **sessions** - активные сессии пользователей

Все данные сохраняются в файле `valve_portal.db` в корне проекта и не теряются при перезапуске сервера.

**Примечание:** Для продакшена с большой нагрузкой рекомендуется использовать PostgreSQL.

## Документация API

После запуска приложения, автоматически генерируется интерактивная документация:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## Разработка

Приложение создано на уровне junior разработчика и демонстрирует:
- Работу с FastAPI и асинхронностью
- Систему авторизации и сессий
- Ролевую модель доступа
- CRUD операции
- Современный веб-дизайн
